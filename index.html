<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
        "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Main</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script type="text/javascript" src="main.js"></script>
    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        .brand-logo {
            margin-left: 1vw;
        }

        .container {
            margin-top: 10vh;
        }

        .rsh4 {
            margin-top: 15vh;
        }

        .section-title {
            margin-bottom: 5vh;
        }

        .btn {
            width: 100%;
        }

        .progress {
            background-color: #e1f5fe;
        }

        .progress .indeterminate {
            background-color: #03a9f4;
        }
    </style>
</head>
<body>
<nav class="nav-extended light-blue darken-3">
    <div class="nav-wrapper">
        <a href="#" class="brand-logo">Parties génératrices</a>
    </div>
    <div class="nav-content">
        <ul class="tabs tabs-transparent">
            <li class="tab"><a class="active" href="#abelian">Abélien</a></li>
            <li class="tab"><a href="#symetric">Symétrique</a></li>
            <li class="tab"><a href="#diedral">Diédral</a></li>
        </ul>
    </div>
</nav>
<div id="abelian" class="col s12">
    <div class="container">
        <h4 class="center section-title">Groupe abélien</h4>
        <div class="row">
            <div class="col s6">
                <input type="number" name="resolve-input" id="abelian_input" placeholder="k?">
            </div>
            <div class="col s2">
                <a class="waves-effect waves-light btn light-blue darken-4" onclick="add_abelian()">
                    <i class="material-icons right">add</i>
                    Add
                </a>
            </div>
            <div class="col s2">
                <a class="waves-effect waves-light btn light-blue darken-4" onclick="clear_abelian_list()">
                    <i class="material-icons right">delete</i>
                    Clear
                </a>
            </div>
            <div class="col s2">
                <a id="abelian_compute_button" class="waves-effect waves-light btn light-blue darken-4" onclick="compute('abelian')">
                    <i class="material-icons right">arrow_forward</i>
                    Compute
                </a>
            </div>
        </div>
        <div id="abelian_loader" class="progress" style="display: none;">
            <div class="indeterminate"></div>
        </div>


        <h4 class="center rsh4"><span id="abelian_latex">\( \pi[\mathbb{Z} / 4 \mathbb{Z} \times \mathbb{Z} / k \mathbb{Z} ]  \)</span>
            = <span id="abelian_result"></span></h4>
    </div>
</div>
<div id="diedral" class="col s12">
    <div class="container">
        <h4 class="center section-title">Groupe Diédral</h4>
        <div class="row">
            <div class="col s10">
                <input type="number" name="resolve-input" id="diedral_input" placeholder="k ?" onkeyup="update_diedral_latex()">
            </div>
            <div class="col s2">
                <a id="diedral_compute_button" class="waves-effect waves-light btn light-blue darken-4" onclick="compute('diedral')">
                    <i class="material-icons right">arrow_forward</i>
                    Compute
                </a>
            </div>
        </div>
        <div id="diedral_loader" class="progress" style="display: none;">
            <div class="indeterminate"></div>
        </div>

        <h4 class="center rsh4"><span id="diedral_latex">\( \pi[ D_{2k}] \)</span> = <span
                id="diedral_result"></span></h4>
    </div>
</div>
<div id="symetric" class="col s12">
    <div class="container">
        <h4 class="center section-title">Groupe Symétrique</h4>
        <div class="row">
            <div class="col s10">
                <input type="number" name="resolve-input" id="symetric_input" placeholder="k ?" onkeyup="update_symetric_latex()">
            </div>
            <div class="col s2">
                <a id="symetric_compute_button" class="waves-effect waves-light btn light-blue darken-4" onclick="compute('symetric')">
                    <i class="material-icons right">arrow_forward</i>
                    Compute
                </a>
            </div>
        </div>
        <div id="symetric_loader" class="progress" style="display: none;">
            <div class="indeterminate"></div>
        </div>
        <h4 class="center rsh4"><span id="symetric_latex">\( \pi[ \mathfrak{S}_{k} ] \)</span> = <span
                id="symetric_result"></span></h4>
    </div>
</div>


</body>
<script type="text/javascript">
    var elems = document.querySelectorAll('.tabs');
    var instance = M.Tabs.init(elems, {});
    var list = [];
    update_latex();
    function add_abelian() {
        let input = document.getElementById("abelian_input");
        list.push(parseInt(input.value))
        update_abelian_latex();
        input.value = "";
    }

    function clear_abelian_list() {
        list = [];
        update_abelian_latex();
    }

    function compute(type) {
        let resultat = document.getElementById(type+"_result");
        loader_change(type, true);
        let computed, input, contenu;
        switch (type) {
            case "abelian":
                computed = ocamlcallback.abelian(list);
                break
            case "symetric":
                input = document.getElementById("symetric_input");
                contenu = parseInt(input.value);
                computed = ocamlcallback.symetric(contenu);
                break
            case "diedral":
                input = document.getElementById("diedral_input");
                contenu = parseInt(input.value);
                computed = ocamlcallback.diedral(2*contenu);
                break
        }
        loader_change(type, false);
        resultat.textContent = "\\("+computed[1].c+"["+computed[3].c+"]\\)";
        MathJax.typeset();
    }


    function update_abelian_latex() {
        let result = document.getElementById("abelian_latex");
        let temporaire = "\\( \\pi [ ";
        for (let index = 0; index < list.length; index++) {
            if (index == list.length - 1) {
                temporaire = temporaire + " \\mathbb{Z}/ " + list[index] + " \\mathbb{Z} ";
            } else {
                temporaire = temporaire + " \\mathbb{Z}/ " + list[index] + " \\mathbb{Z} \\times ";
            }
        }
        temporaire = temporaire + "] \\)";
        result.textContent = temporaire;
        MathJax.typeset();
    }

    function update_symetric_latex() {
        let input = document.getElementById("symetric_input");
        let latex = document.getElementById("symetric_latex");
        latex.textContent = "\\( \\pi[ \\mathfrak{S}_{" + input.value + "} ]  \\)";
        MathJax.typeset();
    }

    function update_diedral_latex() {
        let input = document.getElementById("diedral_input");
        let latex = document.getElementById("diedral_latex");
        latex.textContent = "\\( \\pi[ D_{" + (2*parseInt(input.value)) + "} ]  \\)";
        MathJax.typeset();
    }

    function update_latex() {
        update_abelian_latex();
        update_symetric_latex();
        update_diedral_latex();
    }
    function loader_change(type, state) {
        let bouton = document.getElementById(type+"_compute_button");
        let loader = document.getElementById(type+"_loader");
        if (state){
            bouton.classList.add("disabled");
            loader.style.display = "block";
        }
        else {
            bouton.classList.remove("disabled");
            loader.style.display = "none";
        }
    }

</script>
</html>
